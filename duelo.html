<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokemon vs Cats</title>
    <link rel="stylesheet" href="./css/duelo.css">
</head>

<body>
    <div id="div_duelo" class="duelo">
        <div id="div_jogador" class="jogador"></div>
        <div id="div_oponente" class="oponente"></div>
        <span id="span_nome_oponente" class="nome_oponente"></span>
        <span id="span_nivel_oponente" class="nivel_oponente"></span>
        <span id="span_vida_oponente" class="vida_oponente"></span>
        <span id="span_nome_jogador" class="nome_jogador"></span>
        <span id="span_nivel_jogador" class="nivel_jogador"></span>
        <span id="span_vida_jogador" class="vida_jogador"></span>
        <div id="div_move01" class="move01"></div>
        <div id="div_move02" class="move02"></div>
        <div id="div_move03" class="move03"></div>
        <div id="div_move04" class="move04"></div>
    </div>
</body>
<script>
    window.onload = function () {
        const urlParams = new URLSearchParams(window.location.search)
        const personagem = urlParams.get('idPersonagem')
        const time = urlParams.get('time')

        if (time == 'gato') {
            pegarGatoJogador(personagem)
            pegarPokemonOponente()
        }
        else {
            pegarPokemonJogador(personagem)
            pegarGatoOponente()
        }
    }
    const urlParams = new URLSearchParams(window.location.search)
    const personagem = urlParams.get('idPersonagem')
    const time = urlParams.get('time')
    const nome = urlParams.get('nome')

    async function pegarGatoJogador(jogador) {
        let gatoJogadorPromise = await fetch(`https://api.thecatapi.com/v1/images/${jogador}`)

        let gatoJogadorJSON = await gatoJogadorPromise.json()

        let div = document.getElementById('div_jogador')
        //div.style.setProperty('--gato-imagem', `url(${gatoImagem})`)

        div.style.setProperty('--jogador-imagem', `url(${gatoJogadorJSON.url})`)

        span_nome_jogador.innerHTML = nome
        span_vida_jogador.innerHTML = 100
        span_nivel_jogador.innerHTML = 100

        div_move01.innerHTML = 'arranhar'
        div_move02.innerHTML = 'soltar bola de pelo'
        div_move03.innerHTML = 'lamber a pelagem'
        div_move04.innerHTML = 'miar'

        div_move01.onclick = function () {
            atacar('dano')
        }
        div_move02.onclick = function () {
            atacar('debuff')
        }
        div_move03.onclick = function () {
            atacar('cura')
        }
        div_move04.onclick = function () {
            atacar('buff')
        }


    }
    async function pegarPokemonJogador(jogador) {
        let pokemonJogadorPromise = await fetch(`https://pokeapi.co/api/v2/pokemon/${jogador}`)

        let pokemonJogadorJSON = await pokemonJogadorPromise.json()

        let div = document.getElementById('div_jogador')
        //div.style.setProperty('--pokemon-imagem', `url(${pokemonImagem})`)

        div.style.setProperty('--jogador-imagem', `url(${pokemonJogadorJSON.sprites.front_default})`)

        span_nome_jogador.innerHTML = nome
        span_vida_jogador.innerHTML = 100
        span_nivel_jogador.innerHTML = 100

        if (nome == 'pikachu') {
            div_move01.innerHTML = 'thunder-shock'
            div_move02.innerHTML = 'strength'
            div_move03.innerHTML = 'headbutt'
            div_move04.innerHTML = 'shock'
            
            div_move01.onclick = function () {
                atacar('dano')
            }
            div_move02.onclick = function () {
                atacar('buff')
            }
            div_move03.onclick = function () {
                atacar('dano')
            }
            div_move04.onclick = function () {
                atacar('dano')
            }
        }
        else if (nome == 'greninja') {
            div_move01.innerHTML = 'low-kick'
            div_move02.innerHTML = 'pound'
            div_move03.innerHTML = 'growl'
            div_move04.innerHTML = 'cut'
            
            div_move01.onclick = function () {
                atacar('dano')
            }
            div_move02.onclick = function () {
                atacar('dano')
            }
            div_move03.onclick = function () {
                atacar('debuff')
            }
            div_move04.onclick = function () {
                atacar('dano')
            }
        }
        else if (nome == 'charizard') {
            div_move01.innerHTML = 'flamethrower'
            div_move02.innerHTML = 'fire-punch'
            div_move03.innerHTML = 'scratch'
            div_move04.innerHTML = 'growl'
            
            div_move01.onclick = function () {
                atacar('dano')
            }
            div_move02.onclick = function () {
                atacar('dano')
            }
            div_move03.onclick = function () {
                atacar('dano')
            }
            div_move04.onclick = function () {
                atacar('debuff')
            }
        }
        else if (nome == 'gyarados') {
            div_move01.innerHTML = 'tackle'
            div_move02.innerHTML = 'hydro-pump'
            div_move03.innerHTML = 'hyper-beam'
            div_move04.innerHTML = 'roar'
            
            div_move01.onclick = function () {
                atacar('dano')
            }
            div_move02.onclick = function () {
                atacar('dano')
            }
            div_move03.onclick = function () {
                atacar('dano')
            }
            div_move04.onclick = function () {
                atacar('debuff')
            }
        }
        else if (nome == 'rayquaza') {
            div_move01.innerHTML = 'swords-dance'
            div_move02.innerHTML = 'ice-beam'
            div_move03.innerHTML = 'hyper-beam'
            div_move04.innerHTML = 'blizzard'
            
            div_move01.onclick = function () {
                atacar('buff')
            }
            div_move02.onclick = function () {
                atacar('dano')
            }
            div_move03.onclick = function () {
                atacar('dano')
            }
            div_move04.onclick = function () {
                atacar('dano')
            }
        }


    }

    async function pegarGatoOponente() {
        const numeroSorteado = Math.floor(Math.random() * 5)

        let gatos = ['BB18hZT2z', 'PoZIVJ124', 'aqi', 'bqu', 'a2q']
        let gatoOponenteNome = gatos[numeroSorteado]

        let gatoOponentePromise = await fetch(`https://api.thecatapi.com/v1/images/${gatoOponenteNome}`)

        let gatoOponenteJSON = await gatoOponentePromise.json()

        let div = document.getElementById('div_oponente')
        //div.style.setProperty('--gato-imagem', `url(${gatoImagem})`)

        div.style.setProperty('--oponente-imagem', `url(${gatoOponenteJSON.url})`)

        span_nome_oponente.innerHTML = gatos[numeroSorteado]
        span_vida_oponente.innerHTML = 100
        span_nivel_oponente.innerHTML = 100

    }

    async function pegarPokemonOponente() {
        const numeroSorteado = Math.floor(Math.random() * 5)

        let pokemon = ['pikachu', 'greninja', 'charizard', 'gyarados', 'rayquaza']
        let pokemonOponenteNome = pokemon[numeroSorteado]

        let pokemonOponentePromise = await fetch(`https://pokeapi.co/api/v2/pokemon/${pokemonOponenteNome}`)

        let pokemonOponenteJSON = await pokemonOponentePromise.json()

        let div = document.getElementById('div_oponente')
        //div.style.setProperty('--pokemon-imagem', `url(${pokemonImagem})`)

        div.style.setProperty('--oponente-imagem', `url(${pokemonOponenteJSON.sprites.front_default})`)

        span_nome_oponente.innerHTML = pokemon[numeroSorteado]
        span_vida_oponente.innerHTML = 100
        span_nivel_oponente.innerHTML = 100
    }
</script>

</html>