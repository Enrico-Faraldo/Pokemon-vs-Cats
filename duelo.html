<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokemon vs Cats</title>
    <link rel="stylesheet" href="./css/duelo.css">
</head>

<body>
    <div id="div_duelo" class="duelo">
        <div id="div_jogador" class="jogador"></div>
        <div id="div_oponente" class="oponente"></div>
        <span class="nome_oponente">oponente</span>
        <span class="nivel_oponente">100</span>
        <span class="vida_oponente">100</span>
        <span class="nome_jogador">jogador</span>
        <span class="nivel_jogador">100</span>
        <span class="vida_jogador">100</span>
        <div id="div_move01" class="move01">arranhar</div>
        <div id="div_move02" class="move02">soltar bola de pelo</div>
        <div id="div_move03" class="move03">lamber o pelo</div>
        <div id="div_move04" class="move04">miar</div>
    </div>
</body>
<script>
    window.onload = function () {
        const urlParams = new URLSearchParams(window.location.search)
        const personagem = urlParams.get('personagem')
        const time = urlParams.get('time')

        if (time == 'gato') {
            pegarGatoJogador(personagem)
            pegarPokemonOponente()
        }
        else {
            pegarPokemonJogador(personagem)
            pegarGatoOponente()
        }
    }
    /*const urlParams = new URLSearchParams(window.location.search)
    const personagem = urlParams.get('personagem')
    const time = urlParams.get('time')*/

    async function pegarGatoJogador(personagem) {
        let gatoJogadorPromise = await fetch(`https://api.thecatapi.com/v1/images/${personagem}`)

        let gatoJogadorJSON = await gatoJogadorPromise.json()

        let div = document.getElementById('div_jogador')
        //div.style.setProperty('--gato-imagem', `url(${gatoImagem})`)

        div.style.setProperty('--jogador-imagem', `url(${gatoJogadorJSON.url})`)


    }
    async function pegarPokemonJogador(personagem) {
        let pokemonJogadorPromise = await fetch(`https://pokeapi.co/api/v2/pokemon/${personagem}`)

        let pokemonJogadorJSON = await pokemonJogadorPromise.json()

        let div = document.getElementById('div_jogador')
        //div.style.setProperty('--pokemon-imagem', `url(${pokemonImagem})`)

        div.style.setProperty('--jogador-imagem', `url(${pokemonJogadorJSON.sprites.front_default})`)
    }

    async function pegarGatoOponente() {
        const numeroSorteado = Math.floor(Math.random() * 5)

        let gatos = ['BB18hZT2z', 'PoZIVJ124', 'aqi', 'bqu', 'a2q']
        let gatoOponenteNome = gatos[numeroSorteado]

        let gatoOponentePromise = await fetch(`https://api.thecatapi.com/v1/images/${gatoOponenteNome}`)

        let gatoOponenteJSON = await gatoOponentePromise.json()

        let div = document.getElementById('div_oponente')
        //div.style.setProperty('--gato-imagem', `url(${gatoImagem})`)

        div.style.setProperty('--oponente-imagem', `url(${gatoOponenteJSON.url})`)

    }

    async function pegarPokemonOponente() {
        const numeroSorteado = Math.floor(Math.random() * 5)

        let pokemon = ['pikachu', 'greninja', 'charizard', 'gyarados', 'rayquaza']
        let pokemonOponenteNome = pokemon[numeroSorteado]

        let pokemonOponentePromise = await fetch(`https://pokeapi.co/api/v2/pokemon/${pokemonOponenteNome}`)

        let pokemonOponenteJSON = await pokemonOponentePromise.json()

        let div = document.getElementById('div_oponente')
        //div.style.setProperty('--pokemon-imagem', `url(${pokemonImagem})`)

        div.style.setProperty('--oponente-imagem', `url(${pokemonOponenteJSON.sprites.front_default})`)
    }
</script>

</html>